<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.kiosk.mapper.Com_staff2Mapper">

	<insert id="create">
		insert into com_staff2
		(real_use_dep_nm,usr_nm,logon_id,st_key,class_nm,posit_nm,telno,img_filenm,email_addr,usr_work_state_code_nm,st_status,engm_se,adi_info7,st_sort,section_cd,team_cd,st_wdt,st_edt)
		values
		(#{real_use_dep_nm},#{usr_nm},#{logon_id},#{st_key},#{class_nm},#{posit_nm},#{telno},#{img_filenm},#{email_addr},#{usr_work_state_code_nm},#{st_status},#{engm_se},#{adi_info7},#{st_sort},#{section_cd},#{team_cd},now(),now())
	</insert>

	<select id="read" resultType="Com_staff2VO">
		select
		st_no,usr_nm,st_key,class_nm,posit_nm,telno,img_filenm,email_addr,usr_work_state_code_nm,st_status,adi_info7,section_cd,team_cd
		from com_staff2
		where
		st_no = #{st_no}
	</select>

	<update id="update">
		update com_staff2 set
		real_use_dep_nm=#{real_use_dep_nm},
		usr_nm=#{usr_nm},posit_nm=#{posit_nm},
		telno=#{telno},img_filenm=#{img_filenm},email_addr=#{email_addr},usr_work_state_code_nm=#{usr_work_state_code_nm},st_status=#{st_status},
		adi_info7=#{adi_info7},section_cd=#{section_cd},team_cd=#{team_cd},st_edt=now()
		where st_no = #{st_no}
	</update>

	<delete id="delete">
		delete from com_staff2 where st_no = #{st_no}
	</delete>

	<select id="listAll" resultType="Com_staff2VO">
		 <![CDATA[
		 select * from com_staff2 
		 ]]>
	</select>

	<select id="lastInsertID" resultType="int">
		SELECT AUTO_INCREMENT
		FROM information_schema.TABLES
		WHERE TABLE_SCHEMA = "kipro"
		AND TABLE_NAME = "com_staff2";
	</select>

	<select id="listPage" resultType="Com_staff2VO">
		 <![CDATA[
		 select 
		 st_no,real_use_dep_nm,usr_nm,logon_id,st_key,class_nm,posit_nm,telno,img_filenm,email_addr,usr_work_state_code_nm,st_status,engm_se,adi_info7,st_sort,section_cd,team_cd,st_wdt,st_edt
		 from 
		 com_staff2 
		 where st_no > 0 
		 order by st_no desc
		 limit #{page}, 10
		 ]]>
	</select>

	<select id="listCriteria" resultType="Com_staff2VO">
		 <![CDATA[
		 select 
		 st_no,real_use_dep_nm,usr_nm,logon_id,st_key,class_nm,posit_nm,telno,img_filenm,email_addr,usr_work_state_code_nm,st_status,engm_se,adi_info7,st_sort,section_cd,team_cd,st_wdt,st_edt
		 from 
		 com_staff2 
		 where st_no > 0 
		 order by st_no desc
		 limit #{pageStart}, #{perPageNum}
	 	]]>
	</select>

	<select id="countPaging" resultType="int">
		 <![CDATA[
		 select 
		 count(st_no) 
		 from 
		 com_staff2 
		 where st_no > 0 
		 ]]>
	</select>

	<sql id="search">
		<if test = "!section_cd.equals('none')">
			 and section_cd = #{section_cd}
		</if>
		<if test = "team_cd != null and !team_cd.equals('none')">
			 and team_cd = #{team_cd}
		</if>
			and usr_nm like CONCAT('%',#{keyword},'%')
	</sql>

	<select id="listSearch" resultType="Com_staff2VO">
		<![CDATA[  
		 select * 
		 from com_staff2 
		 where st_no > 0 
		]]>
		<include refid="search"></include>
  
		<![CDATA[    
		order by st_no desc
		limit #{pageStart}, #{perPageNum}
		]]>
	</select>

	<select id="listSearchCount" resultType="int">
		<![CDATA[  
		  select count(st_no) 
		  from com_staff2 
		  where st_no > 0 
		]]>
		<include refid="search"></include>

	</select>

</mapper>